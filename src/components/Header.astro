---
// src/components/Header.astro
import Maskot from './Maskot.astro'; 

const { isEn, alternatePath, currentPath } = Astro.props;

const navLinks = [
  { name: isEn ? "Home" : "Beranda", path: isEn ? "/en/" : "/id/" },
  { name: isEn ? "Services" : "Layanan", path: isEn ? "/en/services/" : "/id/services/" },
  { name: isEn ? "Blog" : "Blog", path: isEn ? "/en/blog/" : "/id/blog/" },
  { name: isEn ? "About" : "Tentang", path: isEn ? "/en/about/" : "/id/about/" },
  { name: isEn ? "Contact" : "Kontak", path: isEn ? "/en/contact/" : "/id/contact/" },
];

const isActive = (path: string) => {
  if (path === '/id/' || path === '/en/') {
    return currentPath === path;
  }
  return currentPath.startsWith(path);
};
---

<header class="sticky top-0 z-50 bg-background/95 backdrop-blur supports-backdrop-filter:bg-background/80 border-b border-border">
  <nav class="container-custom">
    <div class="flex h-16 items-center justify-between">
      <a href={isEn ? "/en/" : "/id/"} class="flex items-center gap-3 group transition-transform hover:scale-105">
        <Maskot 
          size={48} 
          className="group-hover:rotate-12 transition-all duration-300 drop-shadow-sm" 
        />
        <span class="text-xl font-bold text-foreground tracking-tight">
          >_Do<span class="text-emerald-800">WithSudo</span>
        </span>
      </a>

      {/* Desktop Navigation */}
      <div class="hidden md:flex items-center gap-8">
        {navLinks.map((link) => (
          <a
            href={link.path}
            class={`text-sm font-semibold transition-colors hover:text-emerald-900 ${
              isActive(link.path) 
                ? "text-emerald-900 underline underline-offset-4" 
                : "text-slate-800" 
            }`}
          >
            {link.name}
          </a>
        ))}
      </div>

      <div class="flex items-center gap-2 md:gap-4">
        {/* Switcher Bahasa */}
        <a 
          href={alternatePath}
          class="text-[10px] md:text-xs font-bold px-3 py-1.5 rounded-full border border-border bg-secondary hover:bg-emerald-800 hover:text-white transition-all flex items-center gap-1"
          aria-label="Switch Language"
        >
          {isEn ? "ðŸ‡®ðŸ‡© ID" : "ðŸ‡ºðŸ‡¸ EN"}
        </a>

        {/* Tombol Contact Desktop */}
        <a 
          href={isEn ? "/en/contact" : "/id/contact"} 
          class="hidden md:inline-flex items-center justify-center rounded-md bg-emerald-800 px-4 py-2 text-sm font-bold text-white hover:bg-emerald-900 transition-colors"
        >
          {isEn ? "Get In Touch" : "Hubungi Saya"}
        </a>

        {/* Hamburger Menu Button */}
        <button id="menu-toggle" class="md:hidden p-2 text-foreground" aria-label="Toggle menu">
          <svg id="menu-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
          <svg id="close-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>
    </div>

    {/* Mobile Menu */}
    <div id="mobile-menu" class="hidden md:hidden border-t border-border bg-background pb-6">
      <div class="py-4 space-y-1">
        {navLinks.map((link) => (
          <a
            href={link.path}
            class={`block py-4 px-4 text-lg font-bold transition-colors ${
              isActive(link.path)
                ? "text-emerald-900 bg-secondary"
                : "text-slate-800 hover:bg-secondary"
            }`}
          >
            {link.name}
          </a>
        ))}
        <div class="px-4 pt-4">
           <a 
            href={isEn ? "/en/contact" : "/id/contact"} 
            class="flex w-full items-center justify-center rounded-md bg-emerald-800 py-4 text-base font-bold text-white shadow-lg"
          >
            {isEn ? "Get In Touch" : "Hubungi Saya"}
          </a>
        </div>
      </div>
    </div>
  </nav>

  <script>
    function setupMenu() {
      const menuToggle = document.getElementById('menu-toggle');
      const mobileMenu = document.getElementById('mobile-menu');
      const menuIcon = document.getElementById('menu-icon');
      const closeIcon = document.getElementById('close-icon');

      if (menuToggle && mobileMenu && menuIcon && closeIcon && menuToggle.parentNode) {
        const newToggle = menuToggle.cloneNode(true) as HTMLElement;
        menuToggle.parentNode.replaceChild(newToggle, menuToggle);

        newToggle.addEventListener('click', () => {
          const isHidden = mobileMenu.classList.toggle('hidden');
          if (isHidden) {
            menuIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
          } else {
            menuIcon.classList.add('hidden');
            closeIcon.classList.remove('hidden');
          }
        });
      }
    }

    setupMenu();
    document.addEventListener('astro:after-swap', setupMenu);
  </script>
</header>